import { Telegraf } from 'telegraf';
import { prisma } from '../../services/prisma.js';

export const registerHelp = (bot: Telegraf) => {
  bot.command('help', async (ctx) => {
    const user = ctx.from ? await prisma.user.findUnique({ where: { tgId: String(ctx.from.id) } }) : null;
    const role = user?.role;

    const common = [
      '‚öôÔ∏è –û–±—â–∏–µ –∫–æ–º–∞–Ω–¥—ã:',
      '/start ‚Äî –æ–Ω–±–æ—Ä–¥–∏–Ω–≥ –∏ –±—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è',
      '/help ‚Äî —ç—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞',
      '/cancel ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–π —à–∞–≥/–º–∞—Å—Ç–µ—Ä',
      '',
      '‚ÑπÔ∏è –ü–æ–¥—Å–∫–∞–∑–∫–∏:',
      '‚Ä¢ –í –º–∞—Å—Ç–µ—Ä–µ –∑–∞—è–≤–∫–∏ –º–æ–∂–Ω–æ –≤—ã–±–∏—Ä–∞—Ç—å –≤—Ä–µ–º—è –∫–Ω–æ–ø–∫–∞–º–∏ (–°–µ–≥–æ–¥–Ω—è/–ó–∞–≤—Ç—Ä–∞) –∏–ª–∏ –ø–∏—Å–∞—Ç—å —Ç–µ–∫—Å—Ç–æ–º: ¬´—Å–µ–≥–æ–¥–Ω—è 20:00¬ª, ¬´–∑–∞–≤—Ç—Ä–∞ 19:30¬ª, ¬´12.09 18:00¬ª.',
      '‚Ä¢ –°—Ç–∞—Ç—É—Å—ã –∑–∞—è–≤–æ–∫: üÜï –Ω–æ–≤–∞—è ¬∑ üí¨ –ø–µ—Ä–µ–≥–æ–≤–æ—Ä—ã ¬∑ ‚úÖ –ø—Ä–∏–Ω—è—Ç–∞ ¬∑ ‚ùé –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞ ¬∑ üèÅ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ ¬∑ üö´ –æ—Ç–º–µ–Ω–µ–Ω–∞.',
      '',
    ].join('\n');

    if (role === 'PERFORMER') {
      await ctx.reply(
        [
          common,
          'üéÆ –î–ª—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∏—Ü:',
          '/listing ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–Ω–∫–µ—Ç–æ–π (—Ñ–æ—Ç–æ –∏ –≥–æ–ª–æ—Å–æ–≤–∞—è –ø—Ä–æ–±–∞, —Ü–µ–Ω–∞, –æ–ø–∏—Å–∞–Ω–∏–µ, —Å—Ç–∞—Ç—É—Å)',
          '/requests ‚Äî –≤—Ö–æ–¥—è—â–∏–µ –∏ —Ç–µ–∫—É—â–∏–µ –∑–∞—è–≤–∫–∏ (—á–∞—Ç, –æ–ø–ª–∞—Ç–∞)',
          '/billing ‚Äî —Ç–∞—Ä–∏—Ñ—ã –∏ –±—É—Å—Ç—ã',
          '/payinfo ‚Äî —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∫–ª–∏–µ–Ω—Ç–∞–º)',
        ].join('\n'),
      );
      return;
    }

    if (role === 'ADMIN') {
      await ctx.reply(
        [
          common,
          'üõ† –î–ª—è –∞–¥–º–∏–Ω–æ–≤:',
          '/admin_billing ‚Äî –∑–∞–∫–∞–∑—ã –±–∏–ª–ª–∏–Ω–≥–∞ (–∞–∫—Ç–∏–≤–∞—Ü–∏—è/–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ)',
          // —Å—é–¥–∞ –ø–æ–∑–∂–µ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å /admin_moderation
        ].join('\n'),
      );
      return;
    }

    // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤
    await ctx.reply(
      [
        common,
        'üßë‚Äçüíª –î–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤:',
        '/search [–∏–≥—Ä–∞] ‚Äî –Ω–∞–π—Ç–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∏—Ü—É (–Ω–∞–ø—Ä–∏–º–µ—Ä: /search CS2 –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ /search –¥–ª—è —Å–ø–∏—Å–∫–∞)',
        '/requests ‚Äî –º–æ–∏ –∑–∞—è–≤–∫–∏ (—á–∞—Ç –∏ –æ–ø–ª–∞—Ç–∞)',
      ].join('\n'),
    );
  });
};
